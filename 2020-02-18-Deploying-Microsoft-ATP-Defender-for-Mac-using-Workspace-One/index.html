<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Deploying Microsoft Defender ATP for macOS using Workspace ONE UEM - Robert Terakedis</title><meta name=description content="Converting Jamf templates to Workspace ONE templates"><meta name=author content="Robert Terakedis"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"Robert Terakedis","url":"https:\/\/blog.euc-rt.me\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/blog.euc-rt.me\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/blog.euc-rt.me\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/blog.euc-rt.me\/2020-02-18-Deploying-Microsoft-ATP-Defender-for-Mac-using-Workspace-One\/","name":"Deploying microsoft defender atp for MAC os using workspace one uem"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"Robert Terakedis"},"headline":"Deploying Microsoft Defender ATP for macOS using Workspace ONE UEM","description":"I had a few folks recently approach me on the MacAdmins slack asking for help with deploying Microsoft Defender ATP for Mac. We got it working, but it came down to 2 issues: conflicting documentation and Jamf\/inTune specific templates. Once I was able to parse through the Jamf\/InTune documentation, we were able to put together some guidance. We recently published this guide to the EUC Samples GitHub Repository.\nConflicting Documentation The initial problem I found was some confusion generated by Microsoft\u0026rsquo;s documentation.","inLanguage":"en","wordCount":713,"datePublished":"2020-02-18T00:00:00","dateModified":"2020-02-18T00:00:00","image":"https:\/\/blog.euc-rt.me\/img\/avatar-icon.png","keywords":["macOS"],"mainEntityOfPage":"https:\/\/blog.euc-rt.me\/2020-02-18-Deploying-Microsoft-ATP-Defender-for-Mac-using-Workspace-One\/","publisher":{"@type":"Organization","name":"https:\/\/blog.euc-rt.me\/","logo":{"@type":"ImageObject","url":"https:\/\/blog.euc-rt.me\/img\/avatar-icon.png","height":60,"width":60}}}</script><meta property="og:title" content="Deploying Microsoft Defender ATP for macOS using Workspace ONE UEM"><meta property="og:description" content="Converting Jamf templates to Workspace ONE templates"><meta property="og:image" content="https://blog.euc-rt.me/img/avatar-icon.png"><meta property="og:url" content="https://blog.euc-rt.me/2020-02-18-Deploying-Microsoft-ATP-Defender-for-Mac-using-Workspace-One/"><meta property="og:type" content="website"><meta property="og:site_name" content="Robert Terakedis"><meta name=twitter:title content="Deploying Microsoft Defender ATP for macOS using Workspace ONE UEM"><meta name=twitter:description content="Converting Jamf templates to Workspace ONE templates"><meta name=twitter:image content="https://blog.euc-rt.me/img/avatar-icon.png"><meta name=twitter:card content="summary"><meta name=twitter:site content="@robterakedis"><meta name=twitter:creator content="@robterakedis"><link href=https://blog.euc-rt.me/img/favicon.ico rel=icon type=image/x-icon><meta name=generator content="Hugo 0.83.1"><link rel=alternate href=https://blog.euc-rt.me/index.xml type=application/rss+xml title="Robert Terakedis"><link rel=stylesheet href=https://blog.euc-rt.me/fontawesome/css/all.css><link rel=stylesheet href=https://blog.euc-rt.me/css/bootstrap.min.css><link rel=stylesheet href=https://blog.euc-rt.me/css/main.css><link rel=stylesheet href=https://blog.euc-rt.me/css/fonts.css><link rel=stylesheet href=https://blog.euc-rt.me/css/highlight.min.css><link rel=stylesheet href=https://blog.euc-rt.me/css/codeblock.css><link rel=stylesheet href=https://blog.euc-rt.me/css/photoswipe.min.css><link rel=stylesheet href=https://blog.euc-rt.me/css/photoswipe.default-skin.min.css><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-9354949-17','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button>
<a class=navbar-brand href=https://blog.euc-rt.me/>Robert Terakedis</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=About href=/about/>About</a></li><li class=navlinks-container><a class=navlinks-parent>My Work Content</a><div class=navlinks-children><a href=https://techzone.vmware.com/users/robert-terakedis>VMware EUC TechZone</a>
<a href=https://communities.vmware.com/people/rterakedis/activity>VMware Tech Network</a>
<a href=https://github.com/vmware-samples/euc-samples/tree/master/macOS-Samples>VMware EUC Samples</a>
<a href=https://blogs.vmware.com/euc/author/rterakedis>VMware EUC Blog</a></div></li><li class=navlinks-container><a class=navlinks-parent>Resources</a><div class=navlinks-children><a href=/stickers/>Stickers</a>
<a href=/gettingstarted/>Getting Started</a></div></li><li><a title=Tags href=/tags>Tags</a></li><li><a href=#modalSearch data-toggle=modal data-target=#modalSearch style=outline:none><span class="hidden-sm hidden-md hidden-lg">Search</span> <span id=searchGlyph class="glyphicon glyphicon-search"></span></a></li></ul></div><div class=avatar-container><div class=avatar-img-border><a title="Robert Terakedis" href=https://blog.euc-rt.me/><img class=avatar-img src=https://blog.euc-rt.me/img/avatar-icon.png alt="Robert Terakedis" style=height:100px;width:100px></a></div></div></div></nav><div id=modalSearch class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><button type=button class=close data-dismiss=modal>&#215;</button><h4 class=modal-title>Search Robert Terakedis</h4></div><div class=modal-body><gcse:search></gcse:search></div><div class=modal-footer><button type=button class="btn btn-default" data-dismiss=modal>Close</button></div></div></div></div><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=posts-heading><h1>Deploying Microsoft Defender ATP for macOS using Workspace ONE UEM</h1><hr class=small><h2 class=posts-subheading>Converting Jamf templates to Workspace ONE templates</h2></div></div></div></div></div></header><div class=container role=main><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role=main class=blog-post><p>I had a few folks recently approach me on the MacAdmins slack asking for help with deploying Microsoft Defender ATP for Mac. We got it working, but it came down to 2 issues: conflicting documentation and Jamf/inTune specific templates. Once I was able to parse through the Jamf/InTune documentation, we were able to put together some guidance. We recently published this guide to the <a href=https://github.com/vmware-samples/euc-samples/tree/master/macOS-Samples/3rd-Party_Software_Guidance/Microsoft-Defender-ATP>EUC Samples GitHub Repository</a>.</p><h2 id=conflicting-documentation>Conflicting Documentation</h2><p>The initial problem I found was some confusion generated by Microsoft&rsquo;s documentation. The first article, <a href=https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/mac-preferences>Set Preferences for Microsoft Defender ATP</a> referenced a payloadType of <code>com.microsoft.wdav</code>. These preferences seem related to the UI and various configuration settings. In other words, it controls what changes can be made in the UI if opened by the end-user.</p><p>The second article, <a href=https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/mac-install-with-jamf#configuration-profile>JAMF-based deployment for Microsoft Defender ATP for Mac</a>, referenced a payloadType of <code>com.microsoft.wdav.atp</code>. This &ldquo;MDM Deployment&rdquo; specific article only mentions the profile downloaded as part of the <strong>Onboarding package</strong>. This specific profile looks geared towards licensing and linking the Defender ATP to your specific tenant in the threat protection cloud for telemetry.</p><p>For anyone uninitiated, the <strong>payloadType</strong> in a configuration profile is essentially the key that tells macOS to which preference domain the key-value pairs apply. As such, you&rsquo;ll usually find the payloadType relates to a payloadType.plist file somewhere in <code>/Library/Managed Preferences</code> (or `~/Library/Managed Preferences). Initially, I found it odd that the Defender client would be reading TWO separate preference domains. Also, neither article made mention of the other as a complete &ldquo;story&rdquo; for managing the client.</p><blockquote><p>Don&rsquo;t forget to grant Terminal.app permissions in the Security & Privacy preferences to validate the payloadType.plist in one of the two Managed Preferences locations.</p></blockquote><h2 id=jamf-and-intune-specifics>Jamf and inTune Specifics</h2><p>The <a href=https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/mac-install-with-other-mdm>Deployment with a different MDM system</a> article left a lot to be desired. I find that in this instance, the Jamf-specific deployment information provided the specific detail required for us to put together an appropriate plan. Much of the guidance in that article also applies to Workspace ONE UEM, but with some slightly different terminology:</p><h3 id=jamf-policies--profiles-in-workspace-one-parlance>Jamf Policies = Profiles in Workspace ONE Parlance</h3><p>In Workspace ONE UEM, you need only click <strong>Add > Profile</strong> in the top right corner, and build a macOS Device profile. While we typically suggest only a single payload per profile, in this instance, you need multiple payloads for a single app. Since none of the settings you&rsquo;ll be managing <em>should</em> conflict with other similar payloads, I would suggest creating a single profile with the following two payloads:</p><ul><li>The Custom Settings payload for <code>com.microsoft.wdav</code></li><li>The Custom Settings payload for <code>com.microsoft.wdav.atp</code></li></ul><p>I would then suggest creating separate profiles with each individual payload as follows (or add the information to a pre-existing profile containing the specific payload):</p><ul><li>The Kernel Extension payload whitelisting the Team ID: <code>UBF8T346G9</code></li><li>The Privacy Preferences payload granting <code>com.microsoft.wdav</code> the <em>SystemPolicyAllFiles</em> entitlement</li></ul><blockquote><p>With regards to the Notification Settings payload, I recommend testing this setting with other apps in your environment generating notifications. In my experience, some apps in some versions of macOS have shown unintended behaviors when managing notification settings via MDM.</p></blockquote><p>As you go to build the Custom Settings payloads, it&rsquo;s important to note that Workspace ONE UEM expects ONLY the payloadType dictionary (e.g. <code>&lt;dict>...&lt;/dict></code>) and not the full mobileconfig profile with the <em>Configuration</em> wrapper. What this means is you&rsquo;ll need to trim down the content of the payload to make it work in Workspace ONE. I cover some of these basics in the <a href=https://github.com/vmware-samples/euc-samples/blob/master/macOS-Samples/CustomXMLProfiles/CustomXMLTemplate.md>Custom XML Payloads</a> document on the EUC-Samples github repo.</p><blockquote><p>When adding multiple custom settings to a profile, use the plus sign (+) to add additional custom settings payloads. <strong>DO NOT</strong> paste multiple custom settings payloadType dictionaries (&mldr;) in the same text box (e.g. a single payload).</p></blockquote><h3 id=jamf-packages--internal-apps-in-workspace-one-parlance>Jamf Packages = Internal Apps in Workspace ONE Parlance</h3><p>To deliver the <code>wdav.pkg</code> file to devices, you should parse it with the <a href=https://docs.vmware.com/en/VMware-Workspace-ONE-UEM/2001/Software_Distribution/GUID-AWT-ADMINASSIST.html>VMware AirWatch Admin Assistant</a> app. You can then upload the package and plist as an internal macOS application. Next, paste the uninstall script in the uninstall script textbox for the Internal app.</p><h2 id=summary>Summary</h2><p>In my experience, you can distill documentation meant for a different MDM or UEM vendor into a valid, workable solution for Workspace ONE. Also, when you find documentation that is confusing or incomplete, don&rsquo;t hesitate to file feedback!</p><div class=blog-tags><a href=https://blog.euc-rt.me//tags/macos/>macOS</a>&nbsp;</div><hr><section id=social-share><div class="list-inline footer-links"><div class=share-box aria-hidden=true><ul class=share><li><a href="//twitter.com/share?url=https%3a%2f%2fblog.euc-rt.me%2f2020-02-18-Deploying-Microsoft-ATP-Defender-for-Mac-using-Workspace-One%2f&text=Deploying%20Microsoft%20Defender%20ATP%20for%20macOS%20using%20Workspace%20ONE%20UEM&via=robterakedis" target=_blank title="Share on Twitter"><i class="fab fa-twitter"></i></a></li><li><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.euc-rt.me%2f2020-02-18-Deploying-Microsoft-ATP-Defender-for-Mac-using-Workspace-One%2f" target=_blank title="Share on Facebook"><i class="fab fa-facebook"></i></a></li><li><a href="//reddit.com/submit?url=https%3a%2f%2fblog.euc-rt.me%2f2020-02-18-Deploying-Microsoft-ATP-Defender-for-Mac-using-Workspace-One%2f&title=Deploying%20Microsoft%20Defender%20ATP%20for%20macOS%20using%20Workspace%20ONE%20UEM" target=_blank title="Share on Reddit"><i class="fab fa-reddit"></i></a></li><li><a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fblog.euc-rt.me%2f2020-02-18-Deploying-Microsoft-ATP-Defender-for-Mac-using-Workspace-One%2f&title=Deploying%20Microsoft%20Defender%20ATP%20for%20macOS%20using%20Workspace%20ONE%20UEM" target=_blank title="Share on LinkedIn"><i class="fab fa-linkedin"></i></a></li><li><a href="//www.stumbleupon.com/submit?url=https%3a%2f%2fblog.euc-rt.me%2f2020-02-18-Deploying-Microsoft-ATP-Defender-for-Mac-using-Workspace-One%2f&title=Deploying%20Microsoft%20Defender%20ATP%20for%20macOS%20using%20Workspace%20ONE%20UEM" target=_blank title="Share on StumbleUpon"><i class="fab fa-stumbleupon"></i></a></li><li><a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fblog.euc-rt.me%2f2020-02-18-Deploying-Microsoft-ATP-Defender-for-Mac-using-Workspace-One%2f&description=Deploying%20Microsoft%20Defender%20ATP%20for%20macOS%20using%20Workspace%20ONE%20UEM" target=_blank title="Share on Pinterest"><i class="fab fa-pinterest"></i></a></li></ul></div></div></section><h4 class=see-also>See also</h4><ul><li><a href=/posts/new-key-added-softwareupdate-command-macos/>New Key Added to SoftwareUpdate Command in macOS</a></li><li><a href=/posts/converting-jamf-custom-schema-json-workspace-one-uem/>Converting Jamf Custom Schema JSON for Workspace ONE UEM</a></li><li><a href=/posts/troubleshooting-macos-management-with-workspace-one/>Troubleshooting macOS Management with Workspace ONE</a></li><li><a href=/posts/deploying-nomad-over-vmware-per-app-tunnel/>Deploying NoMAD over VMware Per-App Tunnel</a></li><li><a href=/posts/modify-zshell-defaults/>Modify ZShell Defaults in macOS</a></li></ul></article><ul class="pager blog-pager"><li class=previous><a href=https://blog.euc-rt.me/2020-02-04-macOS-Catalina-Kerberos-SSO-Over-VPN/ data-toggle=tooltip data-placement=top title="Testing macOS Catalina Kerberos SSO Extension Over VPN">&larr; Previous Post</a></li><li class=next><a href=https://blog.euc-rt.me/2020-03-06-organizing-adapted-digital-bullet-journal-ipad-goodnotes/ data-toggle=tooltip data-placement=top title="My Adapted Digital Bullet Journal via iPad Pro and GoodNotes 5">Next Post &rarr;</a></li></ul><script src=https://utteranc.es/client.js repo=rterakedis/rterakedis.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></div></div><footer><div class=container><div class=row><div class=disclaimer><b>Disclaimer:</b> The opinions expressed herein are my own personal opinions and do not represent my employer’s view in any way.</div></div><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=https://github.com/rterakedis title=GitHub><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://twitter.com/robterakedis title=Twitter><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://linkedin.com/in/terakedis title=LinkedIn><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li><li><a href title=RSS><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted"><a href=https://blog.euc-rt.me>Robert Terakedis</a>
&nbsp;&bull;&nbsp;&copy;
2021
&nbsp;&bull;&nbsp;
<a href=https://blog.euc-rt.me/>Not to be confused with Pterodactyl...</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.83.1</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script src=https://blog.euc-rt.me/js/katex.min.js></script><script src=https://blog.euc-rt.me/js/auto-render.min.js></script><script src=https://blog.euc-rt.me/js/jquery.min.js></script><script src=https://blog.euc-rt.me/js/bootstrap.min.js></script><script src=https://blog.euc-rt.me/js/main.js></script><script src=https://blog.euc-rt.me/js/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><script>$(document).ready(function(){$("pre.chroma").css("padding","0")})</script><script>renderMathInElement(document.body)</script><script src=https://blog.euc-rt.me/js/photoswipe.min.js></script><script src=https://blog.euc-rt.me/js/photoswipe-ui-default.min.js></script><script src=https://blog.euc-rt.me/js/load-photoswipe.js></script><script>(function(){var c='006263833525848905237:3xfwgq6zswl',a=document.createElement('script'),b;a.type='text/javascript',a.async=!0,a.src='https://cse.google.com/cse.js?cx='+c,b=document.getElementsByTagName('script')[0],b.parentNode.insertBefore(a,b)})()</script></body></html>